# 7.1

## B站区块链网课

### **肖臻教授第7节** **BTC挖矿难度**

#### 挖矿难度

挖矿就是不断尝试区块块头中的nonce和extra nonce的值，使得：

![QQ截图20210701094326](../assets/7.1/QQ截图20210701094326.png)



target越小，目标难度越大。比特币中使用的哈希函数是SHA-256，产生的哈希值是256位的，所以整个输出空间是2的256次方 ，调整目标空间所占的比例，在这个问题里直观的来看就是最后得到的哈希值前面有多少位0（这只是通俗直观来看的），这个0越多显然值就越小，也就是挖矿难度越大了。

#### 为什么要调整挖矿难度？

系统中的总算力越来越强，如果挖矿难度保持不变，那么平均出块时间会越来越短，这会造成一些问题。如果出块时间很短，就会导致分叉过多（因为相比于出块时间，可以认为网络上传输的时间变长了），这样**诚实结点的算力就被分散了**，这时恶意结点要进行**51% attack**很可能就不需要50%以上的算力了，可能百分之十几就足够了，这样大大降低了比特币系统的安全性。

#### 如何调整挖矿难度？

比特币协议中规定，每隔2016个区块（大约每2个星期）要重新调整一下目标阈值target，具体的迭代更新公式是：

![QQ截图20210701141553](../assets/7.1/QQ截图20210701141553.png)

为了避免系统中出现某些意外情况，导致系统出现非常大的波动，每次对目标阈值target的调整最大不能超过4倍，最小不能小于1/4。



### **肖臻教授第8节 BTC挖矿**

#### 全节点

![QQ截图20210701142747](../assets/7.1/QQ截图20210701142747.png)

#### 轻节点

![QQ截图20210701142631](../assets/7.1/QQ截图20210701142631.png)

#### 比特币挖矿的趋势：大型矿池

单个矿工挖矿的收益是很不稳定的，平均出块时间10分钟是对于比特币系统中的所有矿工而言的。

矿池将很多矿工组织起来，一般的架构就是一个**矿主（pool manager）全结点**去驱动很多矿机，下属矿工只负责计算哈希值，全结点的其它职能只由矿主来承担。有了收益以后再大家一起分配。

![20190709205242124 (1)](../assets/7.1/20190709205242124 (1).png)



